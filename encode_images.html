<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core@3.16.0/dist/tf-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-cpu@3.16.0/dist/tf-backend-cpu.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-tflite@0.0.1-alpha.8/dist/tf-tflite.min.js"></script>

<img id="inputImg" onload="window.start()" src="https://i.imgur.com/gGaHL3E.jpg" style="max-height:300px">

<script type="module">
  window.start = async function() {
    let tfliteModel = await tflite.loadTFLiteModel('https://huggingface.co/rocca/lit-web/resolve/main/embed_images.tflite');
    const outputTensor = tf.tidy(() => {
      // Get pixels data from an image.
      let img = tf.browser.fromPixels(inputImg);
      // Resize and normalize:
      img = tf.image.resizeBilinear(img, [224, 224]);
      img = tf.sub(tf.div(tf.expandDims(img), 127.5), 1);
      // Run the inference.
      let outputTensor = tfliteModel.predict(img);
      // De-normalize the result.
      return tf.mul(tf.add(outputTensor, 1), 127.5)
    });
    console.log(outputTensor);
  }
</script>
